(()=>{var e={823:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});const s={assetsURL:"/static/",debug:!1}},237:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});const s={find:(e,t,r=!1)=>{let s=[];for(let a of e){const e=Object.keys(t).reverse();let n=e.length;for(;n>0&&a[e[n-1]]===t[e[n-1]];n--)if(0===n){if(r)return a;s.push(a)}}return s.length>0&&s}},a={find:(e,t)=>s.find.call(null,e,t,!0),findAll:(e,t)=>s.find.call(null,e,t,!1)},n={resolveReady:e=>{"complete"===document.readyState?e():window.addEventListener("DOMContentLoaded",(()=>{e()}))}};var i=r(823).default;const o={data:a,dom:n,json:{encode:e=>{try{return JSON.stringify(e)}catch(t){return console.error(`JsonError: Failed to encode : ${e}`),!1}},decode:(e,t)=>{try{let r=JSON.parse(e);return!t||r}catch(t){return i.debug&&console.error(`JsonError: Failed to decode : ${e}`),!1}}}}},18:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});const s=new Object},139:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=139,e.exports=t},854:e=>{function t(e){return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}))}t.keys=()=>[],t.resolve=t,t.id=854,e.exports=t}},t={};function r(s){if(t[s])return t[s].exports;var a=t[s]={exports:{}};return e[s](a,a.exports,r),a.exports}r.d=(e,t)=>{for(var s in t)r.o(t,s)&&!r.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";var e=r(237).default,t=r(18).default;const s=[{label:"page_data_extracter",priority:2,callback:()=>{const r=document.scripts.namedItem("p-data");if(r){const s=r.textContent;if(s){const r=e.json.decode(s,!0);if(r&&"params"in r)return void Object.assign(t,{pdata:r})}}}}];var a=new WeakMap;class n extends Error{constructor(e){super(e.log),a.set(this,{writable:!0,value:'<div class="error critical-error"><p class="error-msg"><span>A Critical Error Occurred! May you attempt accessing this page later ? Thanks !</span></p></div>'});const t=this.template(e.doc);this.dispatchError(t)}dispatchError(e){const t=document.body;for(let e in t.attributes)"wrapper"!==e&&t.removeAttribute(e);t.innerHTML=e}template(e){return e?`<div class="error critical-error"><p class="error-msg">${e}</p></div>`:function(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}(this,a)}}var i=r(18).default,o=r(237).default,l=r(823).default;function c(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function d(e,t,r){var s=t.get(e);if(!s)throw new TypeError("attempted to set private field on non-instance");if(s.set)s.set.call(e,r);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=r}return r}var p=new WeakMap,u=new WeakMap,h=new WeakMap,f=new WeakMap;const v=class{constructor(){p.set(this,{writable:!0,value:void 0}),u.set(this,{writable:!0,value:void 0}),h.set(this,{writable:!0,value:void 0}),f.set(this,{writable:!0,value:void 0}),d(this,u,s),d(this,p,[]),d(this,h,this.initLog(!0)),d(this,f,{label:"",callback:new Function})}initLog(e=!1){if(d(this,h,{label:"",state:0}),!0===e)return c(this,h)}loadRepository(e){const t=[];for(let r of["preset","current"]){let s=e[r]||[];"current"===r&&s.length<=0&&e.pages&&s.push(...e.pages[i.data.params.pagename]||[]),t.push(...s)}return t}executeTms(e){try{e.callback(),e.observe&&i.observers.push(e.observe),c(this,h).state=1}catch(t){const r=e.priority;if(e.fallback){let t=this.resolveFallback();if(!(t&&t instanceof Function))throw`TmsError: Undefined [Fallback.callback] of Tms: ${e.label}`;t()}if(3===r)throw t}this.report()}executeCurrentQueue(e=!1){return new Promise(((t,r)=>{for(let e;e=c(this,u).shift();)d(this,f,e),o.data.find(c(this,p),{label:c(this,f).label,state:1})||(c(this,h).label=c(this,f).label,this.resolveDepencies()||(this.executeTms(c(this,f)),this.resolveAttach()));e&&console.log(c(this,p))}).bind(this))}resolveDepencies(){const e=c(this,f).depend_on;if(!(e instanceof Array)||e.length<=0)return!1;const t=[c(this,f)];for(let r;r=e.shift();){const e=o.data.find(c(this,p),{label:r});if(e){if(1===e.state)continue;throw new n({log:e.msg||`[${e.label}] as Tms dependencie had failed to run !`})}{const e=o.data.find(c(this,u),{label:r});if(!e){console.error(`${r} not registered as Tms !`);break}t.unshift(e)}}return t.length>1?(c(this,h).state=2,this.report(),c(this,u).unshift(...t),!0):void 0}resolveAttach(){if(c(this,f).attach&&c(this,f).attach instanceof Array)for(let e;e=c(this,f).attach.pop();){const t=o.data.find(c(this,u),{label:e});t&&c(this,u).unshift(t)}}resolveFallback(){const e=c(this,f).fallback;let t;if(e){if(!(e instanceof Function))return"reported"===e.options.type&&e.options.content?c(this,u).push(c(this,f)):this.RetryTms(c(this,f)),new Function;t=e}return t}async RetryTms(e){const t=e.fallback.options.content;t.n-- >0&&setTimeout((()=>{this.executeTms(e)}),t.delay)}process(e,t){return d(this,u,this.loadRepository(e)),t&&c(this,u).push(t),this.executeCurrentQueue(l.debug)}postDefault(){return this.executeCurrentQueue(!0)}report(){""!==c(this,h).label&&c(this,p).push(c(this,h)),this.initLog()}},m=class{loadRepository(e){return Promise.resolve()}};var b=r(18).default;const g=new class{refactor(e){const t={tms:{},listeners:{}};if(!e)return t;if("pages"in e){var r,s;"preset"in e&&Object.assign(t,{tms:{preset:(null===(r=e.preset)||void 0===r?void 0:r.tms)||[]},listeners:{preset:(null===(s=e.preset)||void 0===s?void 0:s.listeners)||[]}}),Object.assign(t.listeners,{pages:{}}),Object.assign(t.tms,{pages:{}});for(let r in e.pages)Object.assign(t.listeners.pages,{[r]:e.pages[r].listeners||{}}),Object.assign(t.tms.pages,{[r]:e.pages[r].tms||[]})}else("tms"in e||"listeners"in e)&&Object.assign(t,{tms:{current:this.resolveTmsInput(e.tms)},listeners:{current:e.listeners||{}}});return t}resolveTmsInput(e){return"object"==typeof e?e instanceof Array?e:[e]:"function"==typeof e?[{label:`${b.data.params.pagename}_main_script`,callback:e}]:[]}};var w=r(18).default,y=r(237).default;function O(e,t){var r=t.get(e);if(!r)throw new TypeError("attempted to get private field on non-instance");return r.get?r.get.call(e):r.value}function T(e,t,r){var s=t.get(e);if(!s)throw new TypeError("attempted to set private field on non-instance");if(s.set)s.set.call(e,r);else{if(!s.writable)throw new TypeError("attempted to set read only private field");s.value=r}return r}var k=new WeakMap,E=new WeakMap,j=new WeakMap;new class{constructor(e){k.set(this,{writable:!0,value:void 0}),E.set(this,{writable:!0,value:void 0}),j.set(this,{writable:!0,value:void 0}),this.init(),T(this,k,e),T(this,E,new v),T(this,j,new m)}init(){Object.assign(w,{app:this,cai:{}})}async loadCurrent(){await O(this,E).postDefault(),r(854)(`./${this.resolveSection(O(this,k).sections)}/app.ts`).then((({default:e})=>{this.process(g.refactor(e))})).catch((e=>{throw new n({log:e})}))}loadPart(e,t,s=1){r(139)(`./${this.resolvePartSection(e,s)}.part.ts`).then((async({default:e})=>{e=g.refactor(e),O(this,j).loadRepository(e.listeners);const r=O(this,E).process(e.tms);t&&r.then(t.done).catch(t.fail).finally(t.complete)})).catch((t=>{if(s>0)return this.loadPart(e,void 0,--s);throw t}))}resolvePartSection(e,t){const r=w.data.params;e=e.replace(".","/");let s="";return s+=`${r.container+(1===t?"/"+r.pagename:"")}/${e}`,`${s}.app`}resolveSection(e){const t=w.data.params;let r=t.container;if("object"==typeof e&&e.options){let s=y.data.find(e.options,{name:t.pagename});s&&(r+=`/pg/${s.pathname||s.name}`)}return r}async process(e){await O(this,E).process(e.tms),O(this,j).loadRepository(e.listeners)}start(){y.dom.resolveReady(this.loadCurrent.bind(this))}}({sections:{}}).start()})()})();
